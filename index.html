<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Daily News — Next Week</title>
  <style>
    body{margin:0;background:#0b0f0c;color:#e6f0ea;font-family:system-ui,Arial}
    .wrap{max-width:900px;margin:0 auto;padding:20px 16px 56px}
    .hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .title{font-size:28px;font-weight:700}
    .btn{background:transparent;border:1px solid #2f7a50;color:#4ade80;padding:6px 10px;border-radius:8px;cursor:pointer}
    .card{background:#101a14;border:1px solid #1b2a21;border-radius:12px;padding:14px 16px;margin-bottom:12px}
    .muted{color:#9fb9ac}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hdr">
      <div class="title">Daily News — Next Week</div>
      <button class="btn" id="refresh">Refresh</button>
    </div>
    <div class="muted" id="meta"></div>
    <div id="list"></div>
  </div>

  <script>
    const WORKER = 'https://green-haze-8240.mikaelalexiou.workers.dev/news';

    async function load() {
      const meta = document.getElementById('meta');
      const list = document.getElementById('list');
      list.innerHTML = '<div class="card">Loading…</div>';

      try {
        const r = await fetch(WORKER + '?v=' + Date.now(), { cache: 'no-store' });
        const j = await r.json();

        meta.textContent = `Serving ${j?.serving_range?.from ?? '?'} → ${j?.serving_range?.to ?? '?'} (${j?.serving_range?.tz ?? ''}) • ${j?.count ?? 0} events • ${j?.version ?? ''}`;

        list.innerHTML = '';
        if (!j.items || !j.items.length) {
          list.innerHTML = '<div class="card">No events for next week yet. Check back later.</div>';
          return;
        }
        j.items.forEach(it => {
          const title = it.title || it.event || 'Event';
          const when  = it.datetime || it.time || it.date || '';
          const badge = it.impact || it.folder || it.importance || '—';
          const country = it.country || it.ccy || '';
          const div = document.createElement('div');
          div.className = 'card';
          div.innerHTML = `<div style="display:flex;justify-content:space-between;gap:12px">
            <div><div style="font-size:16px">${title}</div>
            <div class="muted" style="font-size:13px">${when} ${country ? '• '+country : ''}</div></div>
            <div class="muted" style="font-size:12px;align-self:flex-start;border:1px solid #1b2a21;border-radius:999px;padding:2px 8px">${badge}</div>
          </div>`;
          list.appendChild(div);
        });
      } catch (e) {
        list.innerHTML = `<div class="card">Load failed: ${e?.message || e}</div>`;
      }
    }

    document.getElementById('refresh').addEventListener('click', load);
    load();
  </script>
</body>
</html>
